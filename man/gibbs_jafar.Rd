% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/jafar_gibbs.R
\name{gibbs_jafar}
\alias{gibbs_jafar}
\title{Gibbs Sampler for JAFAR}
\usage{
gibbs_jafar(
  X_m,
  y = NULL,
  yBinary = F,
  K0 = NULL,
  K0_m = NULL,
  tMCMC = 20000,
  tBurnIn = 15000,
  tThin = 10,
  hyperparams = list(),
  get_latent_vars = TRUE,
  get_last_sample = FALSE,
  parallel = TRUE,
  tempered = FALSE,
  rescale_pred = FALSE
)
}
\arguments{
\item{X_m}{Multi-view input data. Rows should correspond to samples, columns to features.
(list of length \code{M}; m-th element: matrix n x p_m\link{m}).}

\item{y}{Vector responses (of length n). Set to NULL for unsupervised mode (default: NULL).}

\item{yBinary}{Logical, indicating if the response(s) are binary (default: FALSE).}

\item{K0}{Upper bound to numbers of shared latent factors (optional)
If NULL, \code{K0} is set to \code{3*log(max(p_m))}}

\item{K0_m}{Upper bounds to numbers of view-specific latent factors (optional)
Length should equal \code{length(X_m)}. If NULL, \code{K0[m]} is set to \code{3*log(max_(p_m[m]))}}

\item{tMCMC}{Total number of MCMC iterations (default: 20000).}

\item{tBurnIn}{Number of burn-in iterations (default: 15000).}

\item{tThin}{Thinning interval for saving samples (default: 10).}

\item{hyperparams}{List of hyperparameters for the D-CUSP prior distributions.
Missing hyperparameters are replaced by defaults encoded in \code{\link{jafar_set_hyperparameters}}.}

\item{get_latent_vars}{Logical, whether to return latent factors and loading matrices (default: TRUE).}

\item{get_last_sample}{Logical, whether to return only the last sample of the MCMC chain (default: FALSE).}

\item{parallel}{Logical, whether to use parallel computation for the loadings' update (default: TRUE).}

\item{tempered}{Logical, temperature parameter for tempered sampling (default: FALSE, no tempering).}

\item{rescale_pred}{Logical, whether to rescale loadings when computing response predictions (default: FALSE).}
}
\value{
A list containing posterior samples, latent variables (if requested), and other relevant model outputs.
}
\description{
Fits a Joint Additive FActor Regression (JAFAR) model using Gibbs sampling.
Variation across multiple data-views is explained via shared and study-specific latent factors.
Default and optional outputs include posterior means of the induced covariances,
posterior samples of residual variances, latent factors, and factor loadings.
Supports parallel computation and tempered updates to limit rank estimation in extreme large-p-small-n settings.
}
\details{
The number of samples in output is \code{tEff=(tMCMC-tBurnIn)\%/\%tThin}.
The output list contains:
\itemize{
\item{\code{K}}{Number shared latent factors (vector of length \code{tEff}).}
\item{\code{K_Gm}}{Number view-specific latent factors (matrix \code{tEff x M}).}
\item{\code{K_Lm_eff}}{Numbers of shared factors active in each view (matrix \code{tEff x M}).}
\item{\code{K_Gm_eff}}{Numbers of specific factors active in each view (matrix \code{tEff x M}).}
\item{\code{active_Lm}}{Binary indicators of shared factors activity across views (binary array \code{tEff x K x M}s).}
\item{\code{Cov_m_mean}}{Posterior mean of the covariance matrix for each dataset (list of length \code{M}; m-th element: matrix \code{p_m[m] x p_m[m]}).}
\item{\code{Marg_Var_m}}{Marginal variances of features (list of length \code{M}; m-th element: matrix \code{tEff x p_m[m]}).}
\item{\code{s2_inv_m}}{Inverse residual variances across views (list of length \code{M}; m-th element: matrix \code{tEff x p_m[m]}).}
\item{\code{mu_m}}{Features intercepts across views (list of length \code{M}; m-th element: matrix \code{tEff x p_m[m]}).}
\item{\code{hyper_param}}{List of hyperparameters used for the model, including user-specified values and defaults ones were missing.}
}
If \code{is_supervised = TRUE}:
\itemize{
\item{\code{K_T_eff}}{Numbers of shared factors active in the response (vector of length \code{tEff}).}
\item{\code{K_Tm_eff}}{Numbers of specific factors active in the response (matrix \code{tEff x M}).}
\item{\code{active_T}}{Binary indicators of shared factors activity in the response (binary matrix \code{tEff x K}).}
\item{\code{active_Tm}}{Binary indicators of specific factors activity in the response (list of length \code{M}; m-th element: matrix \code{tEff x K_Gm[m]}).}
\item{\code{s2_inv}}{Response inverse residual variances (vector of length \code{tEff}).}
\item{\code{mu_y}}{Response intercept (vector of length \code{tEff}).}
\item{\code{Theta}}{Response loadings on shared factors (matrix \code{tEff x K}).}
\item{\code{Theta_m}}{Response loadings on specific factors (list of length \code{M}; m-th element: matrix \code{tEff x K_Gm[m]}).}
\item{\code{y_MC}}{Latent probit utilities (matrix \code{tEff x n}). (only if \code{yBinary = TRUE}).}
}
If \code{get_latent_vars = TRUE}:
\itemize{
\item{\code{Lambda_m}}{Loadings matrices on shared factors (list of length \code{M}; m-th element: array \code{tEff x p_m[m] x K}).}
\item{\code{Gamma_m}}{Loadings matrices on view-specific factors (list of length \code{M}; m-th element: array \code{tEff x p_m[m] x K_Gm[m]}).}
\item{\code{eta}}{Shared latent factors (array \code{tEff x n x K}).}
\item{\code{phi_m}}{View-specific latent factors (list of length \code{M}; m-th element: array \code{tEff x n x K_Gm[m]}).}
}
If the input matrices \code{X_m} contain missing values:
\itemize{
\item{\code{Xm_MC}}{Posterior samples of imputed values for missing entries.
A list of length \code{M}; the m-th element is itself a list (one per feature with missingness),
each containing an \code{tEff Ã— n_miss} matrix of imputed values across MCMC iterations.}
\item{\code{na_idx}}{List of length \code{M}; the m-th element gives the column indices of missing entries in \code{X_m[[m]]}.}
\item{\code{na_row_idx}}{List of length \code{M}; the m-th element gives the corresponding row indices of missing entries in \code{X_m[[m]]}.}
}
If \code{get_last_sample = TRUE}:
\itemize{
\item{\code{last_sample}}{List of posterior values of all parameters at the last MCMC iteration, including latent factors, loadings, residual variances, and hyperparameters.}
}
}
\note{
\itemize{
\item Ensure that all matrices in \code{X_m} have the same number of rows (subjects).
\item Missing data in \code{X_m} are allowed as NA and imputed in the MCMC.
}
}
